{% extends "user/layout/base.html" %}
{% block title %}My Work Items{% endblock %}
{% block content %}

<style>
/* ================================
   USER WORK ITEMS (HARD SCOPED)
   ================================ */
.uwi-scope{
  --border:#e5e7eb;
  --text:#0f172a;
  --muted:#64748b;
  --primary:#4f46e5;
  --warning:#f59e0b;
}

/* ----- Card ----- */
.uwi-card{
  background:#ffffff;
  border-radius:16px;
  border:1px solid var(--border);
  box-shadow:0 6px 18px rgba(15,23,42,.08);
  transition:.25s ease;
  height:100%;
}
.uwi-card:hover{
  transform:translateY(-4px);
  box-shadow:0 14px 34px rgba(15,23,42,.16);
}
.uwi-card.inactive{
  background:#f8fafc;
  border-left:5px solid var(--warning);
  opacity:.92;
}

/* ----- Header ----- */
.uwi-header{
  padding:1rem 1.25rem .75rem;
  border-bottom:1px solid var(--border);
}
.uwi-title{font-weight:600}
.uwi-meta{
  font-size:.78rem;
  color:var(--muted);
}

/* ----- Body ----- */
.uwi-body{
  padding:1rem 1.25rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
}

/* ----- Labels ----- */
.uwi-label{
  font-size:.7rem;
  text-transform:uppercase;
  letter-spacing:.06em;
  color:var(--muted);
}
.uwi-desc{
  font-size:.75rem;
  color:#94a3b8;
}

/* ----- Badges (NO .badge override) ----- */
.uwi-badge{
  font-size:.75rem;
  padding:.35rem .75rem;
  border-radius:999px;
  display:inline-flex;
  align-items:center;
  gap:.45rem;
  font-weight:600;
}

/* Status */
.uwi-status-not-started{background:#e5e7eb;color:#374151}
.uwi-status-working{background:#3b82f6;color:#fff}
.uwi-status-done{background:#10b981;color:#fff}

/* Review */
.uwi-review-pending{background:#fde68a;color:#92400e}
.uwi-review-approved{background:#22c55e;color:#fff}
.uwi-review-revision{background:#ef4444;color:#fff}

/* ----- Animations (icons only) ----- */
.uwi-spin{animation:uwi-spin 1.4s linear infinite}
.uwi-pulse{animation:uwi-pulse 1.2s ease-in-out infinite}
.uwi-bounce{animation:uwi-bounce 1.4s ease infinite}
.uwi-shake{animation:uwi-shake .6s ease-in-out infinite}

@keyframes uwi-spin{to{transform:rotate(360deg)}}
@keyframes uwi-pulse{50%{opacity:.4}}
@keyframes uwi-bounce{50%{transform:translateY(-3px)}}
@keyframes uwi-shake{
  25%{transform:translateX(-2px)}
  50%{transform:translateX(2px)}
  75%{transform:translateX(-2px)}
}

/* ----- Footer ----- */
.uwi-footer{
  margin-top:auto;
  padding:1rem 1.25rem;
  border-top:1px solid var(--border);
  display:flex;
  align-items:center;
}
</style>

<div class="uwi-scope">

<h3 class="mb-4 d-flex align-items-center gap-2">
  <i class="fas fa-clipboard-list text-primary"></i>
  My Assigned Work
</h3>

{% if work_items %}
<div class="row g-4">
{% for item in work_items %}
<div class="col-md-6 col-xl-4">

  <div class="uwi-card {% if not item.is_active %}inactive{% endif %}">

    <!-- HEADER -->
    <div class="uwi-header">
      <div class="uwi-title text-truncate">
        <i class="fas fa-folder-open text-muted me-1"></i>
        {{ item.workcycle.title }}
      </div>
      <div class="uwi-meta mt-1">
        <i class="far fa-calendar-alt me-1"></i>
        Due {{ item.workcycle.due_at|date:"M d, Y Â· H:i" }}
      </div>
    </div>

    <!-- BODY -->
    <div class="uwi-body">

     

      <!-- STATUS -->
      <div>
        <div class="uwi-label">Work Status</div>
        <span class="uwi-badge
          {% if item.status == 'not_started' %}uwi-status-not-started{% endif %}
          {% if item.status == 'working_on_it' %}uwi-status-working{% endif %}
          {% if item.status == 'done' %}uwi-status-done{% endif %}">
          <i class="fas
            {% if item.status == 'not_started' %}fa-pause-circle
            {% elif item.status == 'working_on_it' %}fa-spinner uwi-spin
            {% else %}fa-check-circle{% endif %}">
          </i>
          {{ item.get_status_display }}
        </span>
      </div>

      <!-- REVIEW -->
      <div>
        <div class="uwi-label">Review Status</div>
        <span class="uwi-badge
          {% if item.review_decision == 'pending' %}uwi-review-pending{% endif %}
          {% if item.review_decision == 'approved' %}uwi-review-approved{% endif %}
          {% if item.review_decision == 'revision' %}uwi-review-revision{% endif %}">
          <i class="fas
            {% if item.review_decision == 'pending' %}fa-hourglass-half uwi-pulse
            {% elif item.review_decision == 'approved' %}fa-check uwi-bounce
            {% else %}fa-undo uwi-shake{% endif %}">
          </i>
          {{ item.get_review_decision_display }}
        </span>
      </div>

    </div>

    <!-- FOOTER -->
    <div class="uwi-footer">
      {% if item.is_active %}
        <a href="{% url 'user_app:work-item-detail' item.id %}"
           class="btn btn-sm btn-outline-primary ms-auto">
          <i class="far fa-eye me-1"></i>Open
        </a>
      {% else %}
        <span class="uwi-badge bg-warning text-dark">
          <i class="fas fa-archive me-1"></i>Inactive
        </span>
      {% endif %}
    </div>

  </div>

</div>
{% endfor %}
</div>
{% else %}
<div class="text-muted fst-italic">
  <i class="far fa-folder-open me-1"></i>
  No work items assigned to you.
</div>
{% endif %}

</div>
{% endblock %}
  